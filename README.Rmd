---
output: github_document
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/"
)
```

# studentlife: Seamless tidy handling and convenient navigation of a rich mHealth dataset from Dartmouth


## Install from GitHub with
```{r , eval = FALSE}
# install.packages("devtools")
devtools::install_github("frycast/studentlife")
```

Details on the dataset are available [here](https://studentlife.cs.dartmouth.edu). Once installed, you can download and extract the data within R:

```{r , eval = FALSE}
d <- "studentlife"
library(studentlife)
download_studentlife(dest = d)
```

Then you can use the interactive menu to browse the tables and schemas:

```{r , eval = FALSE}
studs <- studentlife::load_SL_tibble(location = d)
```

Restrictions can be placed on the menu options with `time_options`:

```{r , eval = FALSE}
studs_t <- load_SL_tibble(location = d, time_options = "timestamp", csv_nrows = 10)
studs_p <- load_SL_tibble(location = d, time_options = "interval" , csv_nrows = 10)
studs_d <- load_SL_tibble(location = d, time_options = "dateonly" , csv_nrows = 10)
studs_s <- load_SL_tibble(location = d, time_options = "dateless" , csv_nrows = 10)
```

The `regularise_time` function can be used to summarise information within blocks:

```{r, eval = FALSE}
regularise_time(studs_t, blocks = c("day","week","weekday"))
```


```{r, eval = FALSE}
Mode <- function(x) {
  y <- na.omit(unique(x))
  t <- tabulate(match(x, y))
  v <- which.max(t)
  return(y[v])
}

regularise_time(studs_t, blocks = "day", 
                activity_inference = Mode(activity_inference), 
                add_NAs = FALSE)
```

Produce a histogram showing PAM EMA response frequencies over the course of the study:

```{r, eval = FALSE}
studs_PAM <- load_SL_tibble(schema = "EMA", table = "PAM", location = d)
response_hour_hist(studs_PAM, breaks_by = 10)
```
